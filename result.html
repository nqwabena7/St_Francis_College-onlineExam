<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Exam Results - Admin</title>
<style>
body {
  font-family: "Segoe UI", Arial, sans-serif;
  background: #f8fafc;
  margin: 0;
  padding: 0;
}
.container {
  max-width: 900px;
  margin: 40px auto;
  background: #fff;
  padding: 30px;
  border-radius: 12px;
  box-shadow: 0 15px 30px rgba(0,0,0,0.1);
}
h1 { text-align:center; color:#002147; }
table {
  width: 100%;
  border-collapse: collapse;
  margin-top: 20px;
}
table th, table td {
  border: 1px solid #ccc;
  padding: 10px;
  text-align: center;
}
table th { background:#002147; color:#fff; }
button {
  margin-top: 20px;
  padding: 10px 20px;
  background:#28a745;
  color:#fff;
  border:none;
  border-radius:8px;
  cursor:pointer;
}
button:hover { opacity:0.9; }
button.clear { background:#dc3545; margin-left:10px; }
#loginForm { text-align:center; margin-top:50px; }
#loginForm input { padding:10px; font-size:16px; margin-right:10px; }
#loginForm button { padding:10px 20px; }
</style>
</head>
<body>

<!-- Admin Result Container -->
<div class="container" id="mainContainer" style="display:none;">
  <h1>Exam Results - Admin</h1>
  <table id="resultsTable">
    <thead>
      <tr>
        <th>#</th>
        <th>Name</th>
        <th>Score</th>
        <th>Total</th>
        <th>Percentage</th>
        <th>Grade</th>
        <th>Date</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>
  <button onclick="exportToExcel()">Export to Excel</button>
  <button class="clear" onclick="clearResults()">Clear All Results</button>
</div>

<!-- Admin Login -->
<div id="loginForm">
  <h2>Admin Login</h2>
  <input type="password" id="adminPassword" placeholder="Enter Admin Password">
  <button onclick="checkPassword()">Login</button>
  <p id="errorMsg" style="color:red; margin-top:10px;"></p>
</div>

<script>
// ===== ADMIN LOGIN =====
const adminPassword = "admin123"; // CHANGE THIS TO YOUR SECURE PASSWORD

function checkPassword(){
  const pass = document.getElementById("adminPassword").value;
  if(pass === adminPassword){
    document.getElementById("loginForm").style.display = "none";
    document.getElementById("mainContainer").style.display = "block";
    loadResults();
  } else {
    document.getElementById("errorMsg").innerText = "Incorrect password!";
  }
}

// ===== LOAD RESULTS =====
function loadResults(){
  const results = JSON.parse(localStorage.getItem("exam_results")) || [];
  const tbody = document.querySelector("#resultsTable tbody");
  tbody.innerHTML = "";
  results.forEach((r,i)=>{
    const tr = document.createElement("tr");
    tr.innerHTML = `
      <td>${i+1}</td>
      <td>${r.name}</td>
      <td>${r.score}</td>
      <td>${r.total}</td>
      <td>${r.percentage}%</td>
      <td>${getGrade(r.percentage)}</td>
      <td>${r.date}</td>
    `;
    tbody.appendChild(tr);
  });
}

// ===== GRADE FUNCTION =====
function getGrade(percent){
  if(percent >= 80) return "A";
  if(percent >= 70) return "B";
  if(percent >= 60) return "C";
  if(percent >= 50) return "D";
  return "F";
}

// ===== EXPORT TO EXCEL =====
function exportToExcel(){
  const results = JSON.parse(localStorage.getItem("exam_results")) || [];
  if(results.length === 0) { alert("No results to export"); return; }

  let csvContent = "data:text/csv;charset=utf-8,";
  csvContent += "Name,Score,Total,Percentage,Grade,Date\r\n";
  results.forEach(r=>{
    const row = [r.name,r.score,r.total,r.percentage,getGrade(r.percentage),r.date].join(",");
    csvContent += row + "\r\n";
  });

  const encodedUri = encodeURI(csvContent);
  const link = document.createElement("a");
  link.setAttribute("href", encodedUri);
  link.setAttribute("download", `exam_results_${new Date().toLocaleDateString()}.csv`);
  document.body.appendChild(link);
  link.click();
  document.body.removeChild(link);
}

// ===== CLEAR ALL RESULTS =====
function clearResults(){
  if(confirm("Are you sure you want to delete all exam results? This cannot be undone.")){
    localStorage.removeItem("exam_results");
    loadResults();
    alert("All results have been cleared.");
  }
}
</script>

</body>
</html>
